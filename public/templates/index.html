<main ng-controller="ArticlesController as articleCtrl">
<div id='spacer'></div>
<div class='container'>
  <map default-style="true" zoom="2" center="[40.74, -74.18]">
    <marker  ng-repeat="dest in articleCtrl.dests"
             id="{{dest.articleid}}"
             position="{{dest.lat}}, {{dest.lng}}"
             on-click="map.showInfoWindow({{dest.articleid}})">
    </marker>
    <info-window ng-repeat="dest in articleCtrl.dests" id="{{dest.articleid}}"
                 visible-on-marker="{{dest.articleid}}">
  <div >
    <div id="siteNotice"></div>
    <h1 id="firstHeading" class="firstHeading">{{dest.name}}</h1>
    <div id="bodyContent">
      <p><b>{{dest.location}}</b></p></br>
      <p>{{dest.articlebody}}</p>
      <p></p>
    </div>
  </div>
</info-window>
  </map>

  <br><br><hr>

  <div ng-repeat = "article in articleCtrl.articles">
    <div ng-hide="editorEnabled">
    <span id="artloc">  {{article.location}} </span> </br></br>
      <span id="artbody"> {{article.body}} </span> </br>
      <span id="artvisit">  Visited by: <b>{{article.username}}</b> on {{article.date_traveled | date: 'longDate'}} </span></br>
    <div ng-show="articleCtrl.user === article.username">
    <a href="#" class='linkbutton' ng-click="editorEnabled=!editorEnabled">Edit Your Article</a>
    </div>
    </div>
    <div ng-show="editorEnabled">
      <form ng-submit= "articleCtrl.editArticle(article)">
          <input class="search" places-auto-complete types="['geocode']"
          on-place-changed="findLocation()" ng-model="articleCtrl.editedArticle.location"
            placeholder="{{article.location}}"><br/>
        <!-- <input type="text" ng-model="articleCtrl.editedArticle.location"
          placeholder="{{article.location}}"><br/> -->
          <textarea rows="6" cols="50" ng-model = "articleCtrl.newArticle.body"
            placeholder="{{article.body}}"/></textarea><BR>

        <!-- <input type="text" ng-model="articleCtrl.editedArticle.latitude"
          placeholder="{{article.latitude}}"><br/>
        <input type="text"  ng-model="articleCtrl.editedArticle.longitude"
          placeholder="{{article.longitude}}"><br/> -->
        <input type="date" ng-model="articleCtrl.editedArticle.date_traveled"
          value="{{article.date_traveled | date:'yyyy-MM-dd' }}"><br/>
        <input type="submit" class="linkbutton" value="Submit Edit">
      </form><br>
      <form ng-submit="articleCtrl.deleteArticle(article)">
        <input type="submit" class="linkbutton" value="Delete Article">
      </form><br>
      <a href="#" class="linkbutton" ng-click="editorEnabled=!editorEnabled">Cancel</a>
    </div></br>
      <span> Comments: </span></br>
        <span ng-repeat = "comment in article.comments">
          <span>{{comment.body}} by <b>{{comment.username}}</b></span></br> </span></br>

          <button class="linkbutton" ng-click="commenter=true">Comment</button>
          <div ng-show="commenter">
            <div ng-controller="CommentsController as commentCtrl">
            <form ng-submit="commentCtrl.createComment()">
            <textarea rows="6" cols="50" ng-model="commentCtrl.newCommentBody"/></textarea>
            <br/>
            <input type="submit" class="linkbutton" value="Submit Comment" />

            </form>
            </div>
              <button class="linkbutton" ng-click="commenter=false">Cancel Comment</button>
      </div>
    <hr>
  </div>
</div>

</main>
